import{h as fe,Q as pe,J as he,S as me,M as ge,w as ye,L as R,I as we,a as I,B as ve,X as L,f as b,F as E,j as h,b as X,Y,t as Se,c as Ee,H as x,d as P,e as D,g as Ne,Z as Te,T as be,W as Me,D as xe,i as Ce,k as Ie,l as J,p as j,x as C,m as Re,G as q,u as _e,n as De,q as Le,o as K,r as Oe,s as Q,v as Z,y as Pe,K as $,z as Ve,A as ke,C as Ae,N as Fe,E as V}from"./index-C9-8mdZk.js";const k=new WeakMap;function S(e){return k.has(e)}function He(e){let t=e;for(;t;){if(!S(t)&&!Q(t))return!1;t=V(t)}return!0}function m(e){return k.get(e)}function $e(e,t){k.set(e,t)}function A(e,t){const n=e.tagName,s=e.value;if(P(e,t)){const o=e.type;return n==="INPUT"&&(o==="button"||o==="submit"||o==="reset")?s:!s||n==="OPTION"?void 0:C}if(n==="OPTION"||n==="SELECT")return e.value;if(!(n!=="INPUT"&&n!=="TEXTAREA"))return s}const ze=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,We=/^[A-Za-z]+:|^\/\//,Be=/^data:.*,/i;function Ge(e,t){return e.replace(ze,(n,s,o,r,u,i)=>{const a=o||u||i;if(!t||!a||We.test(a)||Be.test(a))return n;const d=s||r||"";return`url(${d}${Ue(a,t)}${d})`})}function Ue(e,t){try{return Fe(e,t).href}catch{return e}}const Xe=/[^a-z1-6-_]/;function ee(e){const t=e.toLowerCase().trim();return Xe.test(t)?"div":t}function z(e,t){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${t}' style='background-color:silver'%3E%3C/svg%3E`}const v={FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Focus:6,ViewEnd:7,VisualViewport:8,FrustrationRecord:9},T={Document:0,DocumentType:1,Element:2,Text:3,CDATA:4,DocumentFragment:11},g={Mutation:0,MouseMove:1,MouseInteraction:2,Scroll:3,ViewportResize:4,Input:5,TouchMove:6,MediaInteraction:7,StyleSheetRule:8},y={MouseUp:0,MouseDown:1,Click:2,ContextMenu:3,DblClick:4,Focus:5,Blur:6,TouchStart:7,TouchEnd:9},W={Play:0,Pause:1};function te(e){if(!(e===void 0||e.length===0))return e.map(t=>{const n=t.cssRules||t.rules;return{cssRules:Array.from(n,s=>s.cssText),disabled:t.disabled||void 0,media:t.media.length>0?Array.from(t.media):void 0}})}function ne(e,t,n,s){if(t===h.HIDDEN)return null;const o=e.getAttribute(n);if(t===h.MASK&&n!==K&&!Pe.includes(n)&&n!==s.actionNameAttribute){const r=e.tagName;switch(n){case"title":case"alt":case"placeholder":return C}if(r==="IMG"&&(n==="src"||n==="srcset")){const u=e;if(u.naturalWidth>0)return z(u.naturalWidth,u.naturalHeight);const{width:i,height:a}=e.getBoundingClientRect();return i>0||a>0?z(i,a):$}if(r==="SOURCE"&&(n==="src"||n==="srcset"))return $;if(r==="A"&&n==="href")return C;if(o&&n.startsWith("data-"))return C;if(r==="IFRAME"&&n==="srcdoc")return C}return!o||typeof o!="string"?o:ke(o)?Ve(o):o}function Ye(e,t,n){if(t===h.HIDDEN)return{};const s={},o=ee(e.tagName),r=e.ownerDocument;for(let c=0;c<e.attributes.length;c+=1){const l=e.attributes.item(c).name,f=ne(e,t,l,n.configuration);f!==null&&(s[l]=f)}if(e.value&&(o==="textarea"||o==="select"||o==="option"||o==="input")){const c=A(e,t);c!==void 0&&(s.value=c)}if(o==="option"&&t===h.ALLOW){const c=e;c.selected&&(s.selected=c.selected)}if(o==="link"){const c=Array.from(r.styleSheets).find(f=>f.href===e.href),l=O(c);l&&c&&(s._cssText=l)}if(o==="style"&&e.sheet){const c=O(e.sheet);c&&(s._cssText=c)}const u=e;if(o==="input"&&(u.type==="radio"||u.type==="checkbox")&&(t===h.ALLOW?s.checked=!!u.checked:P(u,t)&&delete s.checked),o==="audio"||o==="video"){const c=e;s.rr_mediaState=c.paused?"paused":"played"}let i,a;const d=n.serializationContext;switch(d.status){case 0:i=Math.round(e.scrollTop),a=Math.round(e.scrollLeft),(i||a)&&d.elementsScrollPositions.set(e,{scrollTop:i,scrollLeft:a});break;case 1:d.elementsScrollPositions.has(e)&&({scrollTop:i,scrollLeft:a}=d.elementsScrollPositions.get(e));break}return a&&(s.rr_scrollLeft=a),i&&(s.rr_scrollTop=i),s}function O(e){if(!e)return null;let t;try{t=e.rules||e.cssRules}catch{}if(!t)return null;const n=Array.from(t,Ae()?Je:oe).join("");return Ge(n,e.href)}function Je(e){if(qe(e)&&e.selectorText.includes(":")){const t=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return e.cssText.replace(t,"$1\\$2")}return oe(e)}function oe(e){return je(e)&&O(e.styleSheet)||e.cssText}function je(e){return"styleSheet"in e}function qe(e){return"selectorText"in e}function F(e,t){const n=Ze(e,t);if(!n)return null;const s=m(e)||Qe(),o=n;return o.id=s,$e(e,s),t.serializedNodeIds&&t.serializedNodeIds.add(s),o}let Ke=1;function Qe(){return Ke++}function H(e,t){const n=[];return Z(e,s=>{const o=F(s,t);o&&n.push(o)}),n}function Ze(e,t){switch(e.nodeType){case e.DOCUMENT_NODE:return et(e,t);case e.DOCUMENT_FRAGMENT_NODE:return tt(e,t);case e.DOCUMENT_TYPE_NODE:return nt(e);case e.ELEMENT_NODE:return ot(e,t);case e.TEXT_NODE:return rt(e,t);case e.CDATA_SECTION_NODE:return it()}}function et(e,t){return{type:T.Document,childNodes:H(e,t),adoptedStyleSheets:te(e.adoptedStyleSheets)}}function tt(e,t){const n=Q(e);return n&&t.serializationContext.shadowRootsController.addShadowRoot(e),{type:T.DocumentFragment,childNodes:H(e,t),isShadowRoot:n,adoptedStyleSheets:n?te(e.adoptedStyleSheets):void 0}}function nt(e){return{type:T.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId}}function ot(e,t){const n=ee(e.tagName),s=st(e)||void 0,o=_e(De(e),t.parentNodePrivacyLevel);if(o===h.HIDDEN){const{width:i,height:a}=e.getBoundingClientRect();return{type:T.Element,tagName:n,attributes:{rr_width:`${i}px`,rr_height:`${a}px`,[K]:Le},childNodes:[],isSVG:s}}if(o===h.IGNORE)return;const r=Ye(e,o,t);let u=[];if(Oe(e)&&n!=="style"){let i;t.parentNodePrivacyLevel===o&&t.ignoreWhiteSpace===(n==="head")?i=t:i={...t,parentNodePrivacyLevel:o,ignoreWhiteSpace:n==="head"},u=H(e,i)}return{type:T.Element,tagName:n,attributes:r,childNodes:u,isSVG:s}}function st(e){return e.tagName==="svg"||e instanceof SVGElement}function rt(e,t){const n=q(e,t.ignoreWhiteSpace||!1,t.parentNodePrivacyLevel);if(n!==void 0)return{type:T.Text,textContent:n}}function it(){return{type:T.CDATA,textContent:""}}function at(e,t,n){return F(e,{serializationContext:n,parentNodePrivacyLevel:t.defaultPrivacyLevel,configuration:t})}function se(e){return!!e.changedTouches}function _(e){return e.composed===!0&&J(e.target)?e.composedPath()[0]:e.target}const B=25;function ut(e){return Math.abs(e.pageTop-e.offsetTop-window.scrollY)>B||Math.abs(e.pageLeft-e.offsetLeft-window.scrollX)>B}const ct=(e,t)=>{const n=window.visualViewport,s={layoutViewportX:e,layoutViewportY:t,visualViewportX:e,visualViewportY:t};if(n)ut(n)?(s.layoutViewportX=Math.round(e+n.offsetLeft),s.layoutViewportY=Math.round(t+n.offsetTop)):(s.visualViewportX=Math.round(e-n.offsetLeft),s.visualViewportY=Math.round(t-n.offsetTop));else return s;return s},re=e=>({scale:e.scale,offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,pageLeft:e.pageLeft,pageTop:e.pageTop,height:e.height,width:e.width});function w(e,t){return{data:{source:e,...t},type:v.IncrementalSnapshot,timestamp:R()}}const lt=50;function dt(e,t){const{throttled:n,cancel:s}=L(r=>{const u=_(r);if(S(u)){const i=ie(r);if(!i)return;const a={id:m(u),timeOffset:0,x:i.x,y:i.y};t(w(se(r)?g.TouchMove:g.MouseMove,{positions:[a]}))}},lt,{trailing:!1}),{stop:o}=b(e,document,["mousemove","touchmove"],n,{capture:!0,passive:!0});return{stop:()=>{o(),s()}}}function ie(e){let{clientX:t,clientY:n}=se(e)?e.changedTouches[0]:e;if(window.visualViewport){const{visualViewportX:s,visualViewportY:o}=ct(t,n);t=s,n=o}if(!Number.isFinite(t)||!Number.isFinite(n)){e.isTrusted&&j("mouse/touch event without x/y");return}return{x:t,y:n}}const G={pointerup:y.MouseUp,mousedown:y.MouseDown,click:y.Click,contextmenu:y.ContextMenu,dblclick:y.DblClick,focus:y.Focus,blur:y.Blur,touchstart:y.TouchStart,touchend:y.TouchEnd};function ft(e,t,n){const s=o=>{const r=_(o);if(E(r,e.defaultPrivacyLevel)===h.HIDDEN||!S(r))return;const u=m(r),i=G[o.type];let a;if(i!==y.Blur&&i!==y.Focus){const c=ie(o);if(!c)return;a={id:u,type:i,x:c.x,y:c.y}}else a={id:u,type:i};const d={id:n.getIdForEvent(o),...w(g.MouseInteraction,a)};t(d)};return b(e,document,Object.keys(G),s,{capture:!0,passive:!0})}const pt=100;function ae(e,t,n,s=document){const{throttled:o,cancel:r}=L(i=>{const a=_(i);if(!a||E(a,e.defaultPrivacyLevel)===h.HIDDEN||!S(a))return;const d=m(a),c=a===document?{scrollTop:X(),scrollLeft:Y()}:{scrollTop:Math.round(a.scrollTop),scrollLeft:Math.round(a.scrollLeft)};n.set(a,c),t(w(g.Scroll,{id:d,x:c.scrollLeft,y:c.scrollTop}))},pt),{stop:u}=Se(e,s,"scroll",o,{capture:!0,passive:!0});return{stop:()=>{u(),r()}}}const ht=200;function mt(e,t){const n=Ee(e).subscribe(s=>{t(w(g.ViewportResize,s))});return{stop:()=>{n.unsubscribe()}}}function gt(e,t){const n=window.visualViewport;if(!n)return{stop:I};const{throttled:s,cancel:o}=L(()=>{t({data:re(n),type:v.VisualViewport,timestamp:R()})},ht,{trailing:!1}),{stop:r}=b(e,n,["resize","scroll"],s,{capture:!0,passive:!0});return{stop:()=>{r(),o()}}}function yt(e,t){return b(e,document,["play","pause"],n=>{const s=_(n);!s||E(s,e.defaultPrivacyLevel)===h.HIDDEN||!S(s)||t(w(g.MediaInteraction,{id:m(s),type:n.type==="play"?W.Play:W.Pause}))},{capture:!0,passive:!0})}function wt(e){function t(o,r){o&&S(o.ownerNode)&&r(m(o.ownerNode))}const n=[D(CSSStyleSheet.prototype,"insertRule",({target:o,parameters:[r,u]})=>{t(o,i=>e(w(g.StyleSheetRule,{id:i,adds:[{rule:r,index:u}]})))}),D(CSSStyleSheet.prototype,"deleteRule",({target:o,parameters:[r]})=>{t(o,u=>e(w(g.StyleSheetRule,{id:u,removes:[{index:r}]})))})];typeof CSSGroupingRule<"u"?s(CSSGroupingRule):(s(CSSMediaRule),s(CSSSupportsRule));function s(o){n.push(D(o.prototype,"insertRule",({target:r,parameters:[u,i]})=>{t(r.parentStyleSheet,a=>{const d=U(r);d&&(d.push(i||0),e(w(g.StyleSheetRule,{id:a,adds:[{rule:u,index:d}]})))})}),D(o.prototype,"deleteRule",({target:r,parameters:[u]})=>{t(r.parentStyleSheet,i=>{const a=U(r);a&&(a.push(u),e(w(g.StyleSheetRule,{id:i,removes:[{index:a}]})))})}))}return{stop:()=>{n.forEach(o=>o.stop())}}}function U(e){const t=[];let n=e;for(;n.parentRule;){const o=Array.from(n.parentRule.cssRules).indexOf(n);t.unshift(o),n=n.parentRule}if(!n.parentStyleSheet)return;const s=Array.from(n.parentStyleSheet.cssRules).indexOf(n);return t.unshift(s),t}function vt(e,t){return b(e,window,["focus","blur"],()=>{t({data:{has_focus:document.hasFocus()},type:v.Focus,timestamp:R()})})}function St(e,t,n){const s=e.subscribe(12,o=>{var r,u;o.rawRumEvent.type==="action"&&o.rawRumEvent.action.type==="click"&&!((u=(r=o.rawRumEvent.action.frustration)===null||r===void 0?void 0:r.type)===null||u===void 0)&&u.length&&"events"in o.domainContext&&o.domainContext.events&&o.domainContext.events.length&&t({timestamp:o.rawRumEvent.date,type:v.FrustrationRecord,data:{frustrationTypes:o.rawRumEvent.action.frustration.type,recordIds:o.domainContext.events.map(i=>n.getIdForEvent(i))}})});return{stop:()=>{s.unsubscribe()}}}function Et(e,t){const n=e.subscribe(5,()=>{t({timestamp:R(),type:v.ViewEnd})});return{stop:()=>{n.unsubscribe()}}}function ue(e,t,n=document){const s=e.defaultPrivacyLevel,o=new WeakMap,r=n!==document,{stop:u}=b(e,n,r?["change"]:["input","change"],c=>{const l=_(c);(l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement||l instanceof HTMLSelectElement)&&a(l)},{capture:!0,passive:!0});let i;if(r)i=I;else{const c=[x(HTMLInputElement.prototype,"value",a),x(HTMLInputElement.prototype,"checked",a),x(HTMLSelectElement.prototype,"value",a),x(HTMLTextAreaElement.prototype,"value",a),x(HTMLSelectElement.prototype,"selectedIndex",a)];i=()=>{c.forEach(l=>l.stop())}}return{stop:()=>{i(),u()}};function a(c){const l=E(c,s);if(l===h.HIDDEN)return;const f=c.type;let p;if(f==="radio"||f==="checkbox"){if(P(c,l))return;p={isChecked:c.checked}}else{const N=A(c,l);if(N===void 0)return;p={text:N}}d(c,p);const M=c.name;f==="radio"&&M&&c.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(M)}"]`).forEach(N=>{N!==c&&d(N,{isChecked:!1})})}function d(c,l){if(!S(c))return;const f=o.get(c);(!f||f.text!==l.text||f.isChecked!==l.isChecked)&&(o.set(c,l),t(w(g.Input,{id:m(c),...l})))}}const Nt=100,Tt=16;function bt(e){let t=I,n=[];function s(){t(),e(n),n=[]}const{throttled:o,cancel:r}=L(s,Tt,{leading:!1});return{addMutations:u=>{n.length===0&&(t=xe(o,{timeout:Nt})),n.push(...u)},flush:s,stop:()=>{t(),r()}}}function ce(e,t,n,s){const o=we();if(!o)return{stop:I,flush:I};const r=bt(i=>{Mt(i.concat(u.takeRecords()),e,t,n)}),u=new o(ve(r.addMutations));return u.observe(s,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{u.disconnect(),r.stop()},flush:()=>{r.flush()}}}function Mt(e,t,n,s){const o=new Map;e.filter(l=>l.type==="childList").forEach(l=>{l.removedNodes.forEach(f=>{le(f,s.removeShadowRoot)})});const r=e.filter(l=>l.target.isConnected&&He(l.target)&&E(l.target,n.defaultPrivacyLevel,o)!==h.HIDDEN),{adds:u,removes:i,hasBeenSerialized:a}=xt(r.filter(l=>l.type==="childList"),n,s,o),d=Ct(r.filter(l=>l.type==="characterData"&&!a(l.target)),n,o),c=It(r.filter(l=>l.type==="attributes"&&!a(l.target)),n,o);!d.length&&!c.length&&!i.length&&!u.length||t(w(g.Mutation,{adds:u,removes:i,texts:d,attributes:c}))}function xt(e,t,n,s){const o=new Set,r=new Map;for(const f of e)f.addedNodes.forEach(p=>{o.add(p)}),f.removedNodes.forEach(p=>{o.has(p)||r.set(p,f.target),o.delete(p)});const u=Array.from(o);Rt(u);const i=new Set,a=[];for(const f of u){if(c(f))continue;const p=E(f.parentNode,t.defaultPrivacyLevel,s);if(p===h.HIDDEN||p===h.IGNORE)continue;const M=F(f,{serializedNodeIds:i,parentNodePrivacyLevel:p,serializationContext:{status:2,shadowRootsController:n},configuration:t});if(!M)continue;const N=V(f);a.push({nextId:l(f),parentId:m(N),node:M})}const d=[];return r.forEach((f,p)=>{S(p)&&d.push({parentId:m(f),id:m(p)})}),{adds:a,removes:d,hasBeenSerialized:c};function c(f){return S(f)&&i.has(m(f))}function l(f){let p=f.nextSibling;for(;p;){if(S(p))return m(p);p=p.nextSibling}return null}}function Ct(e,t,n){var s;const o=[],r=new Set,u=e.filter(i=>r.has(i.target)?!1:(r.add(i.target),!0));for(const i of u){if(i.target.textContent===i.oldValue)continue;const a=E(V(i.target),t.defaultPrivacyLevel,n);a===h.HIDDEN||a===h.IGNORE||o.push({id:m(i.target),value:(s=q(i.target,!1,a))!==null&&s!==void 0?s:null})}return o}function It(e,t,n){const s=[],o=new Map,r=e.filter(i=>{const a=o.get(i.target);return a&&a.has(i.attributeName)?!1:(a?a.add(i.attributeName):o.set(i.target,new Set([i.attributeName])),!0)}),u=new Map;for(const i of r){if(i.target.getAttribute(i.attributeName)===i.oldValue)continue;const a=E(i.target,t.defaultPrivacyLevel,n),d=ne(i.target,a,i.attributeName,t);let c;if(i.attributeName==="value"){const f=A(i.target,a);if(f===void 0)continue;c=f}else typeof d=="string"?c=d:c=null;let l=u.get(i.target);l||(l={id:m(i.target),attributes:{}},s.push(l),u.set(i.target,l)),l.attributes[i.attributeName]=c}return s}function Rt(e){e.sort((t,n)=>{const s=t.compareDocumentPosition(n);return s&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:s&Node.DOCUMENT_POSITION_CONTAINS||s&Node.DOCUMENT_POSITION_FOLLOWING?1:s&Node.DOCUMENT_POSITION_PRECEDING?-1:0})}function le(e,t){J(e)&&t(e.shadowRoot),Z(e,n=>le(n,t))}function _t(){const e=new WeakMap;return{set(t,n){t===document&&!document.scrollingElement||e.set(t===document?document.scrollingElement:t,n)},get(t){return e.get(t)},has(t){return e.has(t)}}}const Dt=(e,t,n)=>{const s=new Map,o={addShadowRoot:r=>{if(s.has(r))return;const u=ce(t,e,o,r),i=ue(e,t,r),a=ae(e,t,n,r);s.set(r,{flush:()=>u.flush(),stop:()=>{u.stop(),i.stop(),a.stop()}})},removeShadowRoot:r=>{const u=s.get(r);u&&(u.stop(),s.delete(r))},stop:()=>{s.forEach(({stop:r})=>r())},flush:()=>{s.forEach(({flush:r})=>r())}};return o};function Lt(e,t,n,s,o,r){const u=(a=R(),d={status:0,elementsScrollPositions:e,shadowRootsController:t})=>{const{width:c,height:l}=Me(),f=[{data:{height:l,href:window.location.href,width:c},type:v.Meta,timestamp:a},{data:{has_focus:document.hasFocus()},type:v.Focus,timestamp:a},{data:{node:at(document,s,d),initialOffset:{left:Y(),top:X()}},type:v.FullSnapshot,timestamp:a}];return window.visualViewport&&f.push({data:re(window.visualViewport),type:v.VisualViewport,timestamp:a}),f};r(u());const{unsubscribe:i}=n.subscribe(2,a=>{o(),r(u(a.startClocks.timeStamp,{shadowRootsController:t,status:1,elementsScrollPositions:e}))});return{stop:i}}function Ot(){const e=new WeakMap;let t=1;return{getIdForEvent(n){return e.has(n)||e.set(n,t++),e.get(n)}}}function Pt(e){const{emit:t,configuration:n,lifeCycle:s}=e;if(!t)throw new Error("emit function is required");const o=f=>{t(f),Ce("record",{record:f});const p=e.viewHistory.findView();Ie(p.id)},r=_t(),u=Dt(n,o,r),{stop:i}=Lt(r,u,s,n,a,f=>f.forEach(p=>o(p)));function a(){u.flush(),c.flush()}const d=Ot(),c=ce(o,n,u,document),l=[c,dt(n,o),ft(n,o,d),ae(n,o,r,document),mt(n,o),ue(n,o),yt(n,o),wt(o),vt(n,o),gt(n,o),St(s,o,d),Et(s,f=>{a(),o(f)})];return{stop:()=>{u.stop(),l.forEach(f=>f.stop()),i()},flushMutations:a,shadowRootsController:u}}function Vt(e,t,n){const s=new FormData;s.append("segment",new Blob([e],{type:"application/octet-stream"}),`${t.session.id}-${t.start}`);const o={raw_segment_size:n,compressed_segment_size:e.byteLength,...t},r=JSON.stringify(o);return s.append("event",new Blob([r],{type:"application/json"})),{data:s,bytesCount:e.byteLength}}function kt({context:e,creationReason:t,encoder:n}){let s=0;const o=e.view.id,r={start:1/0,end:-1/0,creation_reason:t,records_count:0,has_full_snapshot:!1,index_in_view:Ne(o),source:"browser",...e};Te(o);function u(a,d){r.start=Math.min(r.start,a.timestamp),r.end=Math.max(r.end,a.timestamp),r.records_count+=1,r.has_full_snapshot||(r.has_full_snapshot=a.type===v.FullSnapshot);const c=n.isEmpty?'{"records":[':",";n.write(c+JSON.stringify(a),l=>{s+=l,d(s)})}function i(a){if(n.isEmpty)throw new Error("Empty segment flushed");n.write(`],${JSON.stringify(r).slice(1)}
`),n.finish(d=>{Re(r.view.id,d.rawBytesCount),a(r,d)})}return{addRecord:u,flush:i}}const At=5*be;let de=6e4;function Ft(e,t,n,s,o,r){return Ht(e,()=>$t(t.applicationId,n,s),o,r)}function Ht(e,t,n,s){let o={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:r}=e.subscribe(2,()=>{i("view_change")}),{unsubscribe:u}=e.subscribe(11,a=>{i(a.reason)});function i(a){o.status===1&&(o.segment.flush((d,c)=>{const l=Vt(c.output,d,c.rawBytesCount);me(a)?n.sendOnExit(l):n.send(l)}),ge(o.expirationTimeoutId)),a!=="stop"?o={status:0,nextSegmentCreationReason:a}:o={status:2}}return{addRecord:a=>{if(o.status!==2){if(o.status===0){const d=t();if(!d)return;o={status:1,segment:kt({encoder:s,context:d,creationReason:o.nextSegmentCreationReason}),expirationTimeoutId:ye(()=>{i("segment_duration_limit")},At)}}o.segment.addRecord(a,d=>{d>de&&i("segment_bytes_limit")})}},stop:()=>{i("stop"),r(),u()}}}function $t(e,t,n){const s=t.findTrackedSession(),o=n.findView();if(!(!s||!o))return{application:{id:e},session:{id:s.id},view:{id:o.id}}}function zt(e){const t=he();return{addRecord:n=>{const s=e.findView();t.send("record",n,s.id)}}}function Bt(e,t,n,s,o,r){const u=[],i=l=>{e.notify(14,{error:l}),j("Error reported to customer",{"error.message":l.message})},a=r||fe(t.sessionReplayEndpointBuilder,de,i);let d;if(pe())({addRecord:d}=zt(s));else{const l=Ft(e,t,n,s,a,o);d=l.addRecord,u.push(l.stop)}const{stop:c}=Pt({emit:d,configuration:t,lifeCycle:e,viewHistory:s});return u.push(c),{stop:()=>{u.forEach(l=>l())}}}export{Bt as startRecording};
